#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include <string.h>
#define N 30
#define M 6
void Swapplus(char *a,char *b)
{
    char temp[15];
    strcpy(temp,a);
    strcpy(a,b);
    strcpy(b,temp);
}
void checkplus(char xingming[],int n,int m,double xuehao[],double score[][M],char name[][15])
{
    int i,k,j;
    k=0;
    for(i=0;i<n;i++)
    {
        if(strcmp(xingming,name[i])==0)
        {
            k=i;
            break;
        }
        else
        {
            continue;
        }
    }
    printf("%lf\t",xuehao[k]);
    for(j=0;j<m;j++)
    {
        printf("No.%d course's score is%lf\n",j,score[k][j]);
    }
    puts(name[k]);
}

void check(double xhao,int n,int m,double xuehao[],double score[][M],char name[][15])
{
    int i,k,j;
    k=0;
    for(i=0;i<n;i++)
    {
        if(fabs(xhao-xuehao[i])<1E-4)
        {
            k=i;
            break;
        }
        else
        {
            continue;
        }
    }
    printf("%lf\t",xuehao[k]);
    for(j=0;j<m;j++)
    {
        printf("No.%d course's score is%lf\n",j,score[k][j]);
    }
    puts(name[k]);
}

void printfscore(double a[],double b[],int n,char name[][15])
{
    int i;
    for(i=0;i<n;i++)
    {
        printf("总分:%4lf\n",a[i]);
        printf("学号:%4lf\n",b[i]);
        printf("姓名:%s\n",name[i]);
    }
    printf("\n");
}

void Swap(double*x,double*y)
{
    double temp;
    temp=*x;
    *x=*y;
    *y=temp;
}

void SelectionSort(double a[],double b[],int n,int m,int(*compare)(double a,double b),char p[][15],double c[][M])
{
    int i,j,k,l;
    for(i=0;i<n-1;i++)
    {
        k=i;
        for(j=i+1;j<n;j++)
        {
            if((*compare)(a[j],a[k]))
            {
                k=j;
            }
        }
        if(k!=i)
        {
            Swap(&a[k],&a[i]);
            Swap(&b[k],&b[i]);
            Swapplus(p[k],p[i]);
            for(l=0;l<m;l++)
            {
                Swap(&c[k][l],&c[i][l]);
            }
        }
    }
}

int Ascending(double a,double b)
{
    return a<b;
}

int Descending(double a,double b)
{
    return a>b;
}

void one(int n,int m,double xuehao[],double score[][M],char name[][15])
{
    int i,conter,j;
    conter=1;
    for(i=0;i<n;i++)
    {
        printf("%d student's xuehao:",conter);
        scanf("%lf",&xuehao[i]);
        printf("this student's score:\n");
        for(j=0;j<m;j++)
        {
            printf("this is course No.%d:",j);
            scanf("%lf",&score[i][j]);
            getchar();
        }
        printf("this student's name:");
        gets(name[i]);
        conter++;
    }
}

void two(int n,int m,double score[][M])
{
    int j,i,sum=0;
    double ave;
    for(j=0;j<m;j++)
    {
        for(i=0;i<n;i++)
        {
            sum=sum+score[i][j];
        }
        ave=(double)sum/n;
        printf("No.%d course's total score is:%d,average is:%lf\n",j,sum,ave);
        sum=0;
    }
}

void twoplus(int n,int m,double score[][M],double total[])
{
    int i,j,sum=0;
    double ave;
    for(i=0;i<n;i++)
    {
        for(j=0;j<m;j++)
        {
            sum=sum+score[i][j];
        }
        total[i]=(double)sum;
        ave=(double)sum/m;
        printf("No.%d student's total score is:%d,average is:%lf\n",i,sum,ave);
        sum=0;
    }
}

void three(int n,int m,double xuehao[],double score[][M],char name[][15],double total[])
{
    SelectionSort(total,xuehao,n,m,Descending,name,score);
    printf("Data items in score-descending order\n");
    printfscore(total,xuehao,n,name);
}

void four(int n,int m,double xuehao[],double score[][M],char name[][15],double total[])
{
    SelectionSort(total,xuehao,n,m,Ascending,name,score);
    printf("Data items in score-ascending order\n");
    printfscore(total,xuehao,n,name);
}

void five(int n,int m,double xuehao[],double score[][M],char name[][15],double total[])
{
    SelectionSort(xuehao,total,n,m,Ascending,name,score);
    printf("Data items in xuehao-ascending order\n");
    printfscore(total,xuehao,n,name);
}

void sixplus(int n,int m,double xuehao[],double total[],char name[][15],double score[][M])
{
    int i,j,k;
    for(i=0;i<n-1;i++)
    {
        for(j=i+1;j<n;j++)
        {
            if(strcmp(name[j],name[i])<0)
            {
                Swapplus(name[i],name[j]);
                Swap(&xuehao[i],&xuehao[j]);
                Swap(&total[i],&total[j]);
                for(k=0;k<m;k++)
                {
                    Swap(&score[j][k],&score[i][k]);
                }
            }
        }
    }
    printfscore(total,xuehao,n,name);
}

void six(double xhao,int n,int m,double xuehao[],double score[][M],char name[][15])
{
    check(xhao,n,m,xuehao,score,name);
}

void sevenplus(char xingming[],int n,int m,double xuehao[],double score[][M],char name[][15])
{
    checkplus(xingming,n,m,xuehao,score,name);
}

void seven(int n,int m,double score[][M])
{
    int k;
    for(k=0;k<m;k++)
    {
        int i,yx=0,lh=0,zd=0,jg=0,bjg=0;
        double y,l,z,j,b;
        for(i=0;i<n;i++)
        {
            if(score[i][k]<=100&&score[i][k]>=90)
            {
                yx++;
            }
            else if(score[i][k]<90&&score[i][k]>=80)
            {
                lh++;
            }
            else if(score[i][k]<80&&score[i][k]>=70)
            {
                zd++;
            }
            else if(score[i][k]<70&&score[i][k]>=60)
            {
                jg++;
            }
            else if(score[i][k]<60&&score[i][k]>=0)
            {
                bjg++;
            }
            else
            {
                printf("please check your input number\n");
            }
        }
        y=(double)(yx*100)/n;
        l=(double)(lh*100)/n;
        z=(double)(zd*100)/n;
        j=(double)(jg*100)/n;
        b=(double)(bjg*100)/n;
        printf("in No.%d course\n",k);
        printf("优秀的人有：%d\t占百分比：%lf%%\n",yx,y);
        printf("良好的人有：%d\t占百分比：%lf%%\n",lh,l);
        printf("中等的人有：%d\t占百分比：%lf%%\n",zd,z);
        printf("及格的人有：%d\t占百分比：%lf%%\n",jg,j);
        printf("不及格的人有：%d\t占百分比：%lf%%\n",bjg,b);
    }
}

void eight(int n,int m,double xuehao[],double score[][M],char name[][15],double total[])
{
    int i,j;
    for(i=0;i<n;i++)
    {
        printf("总分:%4lf\n",total[i]);
        printf("学号:%4lf\n",xuehao[i]);
        printf("姓名:%s\n",name[i]);
        printf("平均分:%4lf\n",total[i]/m);
        for(j=0;j<m;j++)
        {
            printf("No.%d course's score is:%lf\n",j,score[i][j]);
        }
    }
    printf("\n");
}

int main()
{
    int choice=0,n,m;
    printf("Number:2020200320129\nsubject No.7-program No.1\n");
    printf("How many students in your class:\n");
    scanf("%d",&n);
    printf("How many courses in it:\n");
    scanf("%d",&m);
    if(n>30)
    {
        printf("please check your students input:\n");
        scanf("%d",&n);
    }
    else if(m>6)
    {
        printf("please check your courses input:\n");
        scanf("%d",&m);
    }
    else if(m>6&&n>30)
    {
        printf("totally wrong!please input right numbers:\n");
        scanf("%d %d",&n,&m);
    }
    double xuehao[N];
    double score[N][M];
    double total[N];
    char name[N][15];
    printf("1.Input record\n");
    printf("2.Calculate total and average score of every course\n");
    printf("3.Calculate total and average score of every student\n");
    printf("4.Sort in descending order by total score of every student\n");
    printf("5.Sort in ascending order by total score of every student\n");
    printf("6.Sort in ascending order by number\n");
    printf("7.Sort in dictionary order by name\n");
    printf("8.Search by number\n");
    printf("9.Search by name\n");
    printf("10.Statistic analysis for every course\n");
    printf("11.List record\n");
    printf("12.Exit\n");
    printf("Please enter your choice:");
    scanf("%d",&choice);
    for(;;)
    {
        if(choice!=1)
        {
            getchar();
            printf("please input 1 as your first choice\n");
            printf("please input the choice:");
            scanf("%d",&choice);
        }
        else
        {
            break;
        }
    }
    for(;;)
    {
        switch(choice)
        {
            case 1:
            {
                one(n,m,xuehao,score,name);
                break;
            }
            case 2:
            {
                twoplus(n,m,score,total);
                break;
            }
            case 3:
            {
                two(n,m,score);
                break;
            }
            case 4:
            {
                three(n,m,xuehao,score,name,total);
                break;
            }
            case 5:
            {
                four(n,m,xuehao,score,name,total);
                break;
            }
            case 6:
            {
                five(n,m,xuehao,score,name,total);
                break;
            }
            case 7:
            {
                sixplus(n,m,xuehao,total,name,score);
                break;
            }
            case 8:
            {
                double xhao;
                printf("please input the number:\n");
                scanf("%lf",&xhao);
                six(xhao,n,m,xuehao,score,name);
                break;
            }
            case 9:
            {
                char xingming[15];
                getchar();
                printf("please input the name:\n");
                scanf("%s",xingming);
                sevenplus(xingming,n,m,xuehao,score,name);
                break;
            }
            case 10:
            {
                seven(n,m,score);
                break;
            }
            case 11:
            {
                eight(n,m,xuehao,score,name,total);
                break;
            }
            case 12:
            {
                exit(0);
            }
            default:
            {
                printf("please check your input number\n");
            }
        }
        printf("1.Input record\n");
        printf("2.Calculate total and average score of every course\n");
        printf("3.Calculate total and average score of every student\n");
        printf("4.Sort in descending order by total score of every student\n");
        printf("5.Sort in ascending order by total score of every student\n");
        printf("6.Sort in ascending order by number\n");
        printf("7.Sort in dictionary order by name\n");
        printf("8.Search by number\n");
        printf("9.Search by name\n");
        printf("10.Statistic analysis for every course\n");
        printf("11.List record\n");
        printf("12.Exit\n");
        printf("Please enter your choice:");
        scanf("%d",&choice);
    }
    return 0;
}
